import*as noUiSlider from"nouislider";import"nouislider/dist/nouislider.min.css";import"./focusingjs.min.css";const FocusingJsTemplate=`
  <link rel="preload" href="//at.alicdn.com/t/font_3143830_bfpbyskko9i.woff2" as="font" type="font/woff2"
      crossOrigin="anonymous">
  <link rel="stylesheet" href="//at.alicdn.com/t/font_3143830_bfpbyskko9i.css">
  <focusing-js class="focusingjs-container">
      <span
        class="iconfont icon-arrowleft"
        style="position: fixed;left: 2rem;top: 1.5rem;font-size: 2rem;cursor: pointer"
        onClick="top.FocusingJsExitMode()"
      ></span>
      <span
        class="iconfont icon-setting"
        style="position: fixed;right: 1.5rem;top: 1.5rem;font-size: 2rem;cursor: pointer"
        onClick="top.FocusingJsToggleEditShow('inline-block')"
      ></span>

      <div class="main-container heti heti--poetry"></div>

      <div class="edit-container-mask" onClick="top.FocusingJsToggleEditShow('none')"></div>

      <div class="edit-container edit-container-enter-ani">
        <div style="position: relative">
          <span
            class="iconfont icon-close"
            style="position: absolute;right: 1.2rem;top: 1.2rem;font-size: 1.5rem;cursor: pointer;color: #333333 !important;"
            onClick="top.FocusingJsToggleEditShow('none')"
          ></span>
        </div>

        <div class="main-color-wrapper">
          <div class="label">主题色</div>
          <div class="main-color-container">
            <div onClick="top.FocusingJsChangeBc(this, '#9DD2DC', '#333333')" class="block"
                 style="background-color: #9DD2DC; color: #333333;">
              <span style="color: #17A34A">-</span>
            </div>
            <div onClick="top.FocusingJsChangeBc(this, '#F0D592', '#333333')" class="block"
                 style="background-color: #F0D592; color: #333333;">Aa
            </div>
            <div onClick="top.FocusingJsChangeBc(this, '#D1BFEB', '#333333')" class="block"
                 style="background-color: #D1BFEB; color: #333333;">Aa
            </div>
            <div onClick="top.FocusingJsChangeBc(this, '#FCF5ED', '#333333')" class="block"
                 style="background-color: #FCF5ED; color: #333333;">Aa
            </div>
            <div onClick="top.FocusingJsChangeBc(this, '#F5F5F5', '#333333')" class="block"
                 style="background-color: #F5F5F5; color: #333333;">Aa
            </div>
            <div onClick="top.FocusingJsChangeBc(this, '#363B3F', '#eeeeee')" class="block"
                 style="background-color: #363B3F; color: #eeeeee;">Aa
            </div>
            <div onClick="top.FocusingJsChangeBc(this, '#222222', '#cccccc')" class="block"
                 style="background-color: #222222; color: #cccccc;">Aa
            </div>
          </div>
        </div>

        <div id="slider-container">
          <div class="slider-item">
            <div class="label">字体大小</div>
            <div id="fontSize-slider"></div>
          </div>
          <div class="slider-item">
            <div class="label">行间距</div>
            <div id="lineHeight-slider"></div>
          </div>
          <div class="slider-item">
            <div class="label">版面宽度</div>
            <div id="width-slider"></div>
          </div>
          <div class="slider-item">
            <div class="label">字间距</div>
            <div id="letterSpacing-slider"></div>
          </div>
          <div class="slider-item">
            <div class="label">字体粗细</div>
            <div id="fontWeight-slider"></div>
          </div>
        </div>

      </div>
    </focusing-js>
  `,LOCALSTORAGE_KEY="focusingjs_style";top.FocusingJsIns=null,top.FocusingJsChangeBc=function(i,e,o){top.FocusingJsIns.changeStyle("backgroundColor",e),top.FocusingJsIns.changeStyle("color",o);const t=document.querySelectorAll("focusing-js .main-color-container .block");t.forEach(i=>{i.innerHTML="Aa"}),i.innerHTML='<span style="color: #17A34A">-</span>'},top.FocusingJsToggleEditShow=function(i){const e=document.querySelectorAll("focusing-js .edit-container-mask")[0],o=document.querySelectorAll("focusing-js .edit-container")[0];i=i,e.style.display=i,o.style.display=i,top.FocusingJsIns.saveSetting()},top.FocusingJsInit=function(){top.FocusingJsIns.init()},top.FocusingJsExitMode=function(){top.FocusingJsIns.close()};export default class FocusingJs{constructor(i){this.id=i,this.styleObj={backgroundColor:"",lineHeight:"",fontSize:"",color:"",letterSpacing:"",fontWeight:"",width:""},this.init()}init(){if(top.FocusingJsIns=this,0===document.querySelectorAll("focusingjs").length){const i=document.querySelectorAll("html")[0],e=document.createElement("div");e.innerHTML=FocusingJsTemplate,i.appendChild(e),this.checkLocalStyle(),setTimeout(()=>{this.initSlider()},300)}this.focusingJsContainer=document.querySelectorAll("focusing-js .main-container")[0],this.focusingJs=document.querySelectorAll("focusing-js")[0]}initSlider(){try{const n=this,s=document.querySelector("focusing-js #lineHeight-slider"),c=document.querySelector("focusing-js #width-slider"),l=document.querySelector("focusing-js #fontSize-slider"),r=document.querySelector("focusing-js #letterSpacing-slider"),d=document.querySelector("focusing-js #fontWeight-slider");o=[s,c,r,d,l],t={start:0,step:20,behaviour:"snap",connect:[!0,!1],range:{min:0,max:100}},o.forEach(i=>{noUiSlider.create(i,t)});const a={0:"3rem",20:"4rem",40:"5rem",60:"6rem",80:"7rem",100:"8rem"},g={0:"100%",20:"90%",40:"85%",60:"80%",80:"70%",100:"60%"},u={0:"1rem",20:"1.5rem",40:"2rem",60:"2.5rem",80:"3rem",100:"3.5rem"},h={0:"0.5rem",20:"0.7rem",40:"0.9rem",60:"1.1rem",80:"1.3rem",100:"1.5rem"},f={0:300,20:400,40:500,60:600,80:700,100:800};function e(i,e,o){e=Math.ceil(e[0]),n.changeStyle(i,o[e])}function i(i,e,o){const t={};for(var n in o)t[o[n]]=n;i.noUiSlider.set(t[e])}i(s,this.styleObj.lineHeight,a),i(c,this.styleObj.width,g),i(l,this.styleObj.fontSize,u),i(r,this.styleObj.letterSpacing,h),i(d,this.styleObj.fontWeight,f),s.noUiSlider.on("slide",function(i){e("lineHeight",i,a)}),c.noUiSlider.on("slide",function(i){e("width",i,g)}),l.noUiSlider.on("slide",function(i){e("fontSize",i,u)}),r.noUiSlider.on("slide",function(i){e("letterSpacing",i,h)}),d.noUiSlider.on("slide",function(i){e("fontWeight",i,f)})}catch(i){console.error("initSlider error",i)}var o,t}open(){(top.FocusingJsIns=this).toggleContainerShow("open");var i=document.querySelectorAll(this.id)[0];this.focusingJsContainer.innerHTML=i.innerHTML}close(){this.toggleContainerShow("close")}toggleContainerShow(i){var e={close:{opacity:0,zIndex:-1},open:{opacity:1,zIndex:9999999}};this.focusingJs.style.opacity=e[i].opacity,this.focusingJs.style.zIndex=e[i].zIndex}checkLocalStyle(){var i=localStorage.getItem(LOCALSTORAGE_KEY);i?(this.styleObj=function(i){i=JSON.parse(i);let e;try{e={backgroundColor:i.backgroundColor,lineHeight:i.lineHeight,fontSize:i.fontSize,fontWeight:i.fontWeight,color:i.color,letterSpacing:i.letterSpacing,width:i.width}}catch(i){localStorage.removeItem(LOCALSTORAGE_KEY),e=o.getDefaultStyle()}return e}(i),this.setStyle()):this.styleObj=this.getDefaultStyle();const o=this}setStyle(){for(var i in this.styleObj)this.changeStyle(i,this.styleObj[i])}getDefaultStyle(){return{backgroundColor:"#D1BFEB",lineHeight:"8rem",fontSize:"2.5rem",color:"#333333",letterSpacing:"0.5rem",fontWeight:500,width:"85%"}}changeStyle(i,e){let o;o=(["backgroundColor","color"].includes(i)?document.querySelectorAll("focusing-js"):document.querySelectorAll("focusing-js .main-container"))[0],o.style[i]=e,this.styleObj[i]=e}saveSetting(){localStorage.setItem(LOCALSTORAGE_KEY,JSON.stringify(this.styleObj))}}